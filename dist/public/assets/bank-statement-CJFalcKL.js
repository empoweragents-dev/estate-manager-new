const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-CkxBhw3_.js","assets/index-BrpuEMYd.js","assets/index-CvfNsG2m.css"])))=>i.map(i=>d[i]);
import{W as G,r as g,e as K,j as e,S as _,L as Q,m as B,X as D,a6 as U,I as R,a8 as A,a9 as Y,aa as L,ab as z,ac as T,a7 as Z,C as m,f as j,i as p,a2 as ee,a as h,P as se,a5 as te,l as le,Y as ae,Z as ne,_ as $,$ as f,a0 as ce,a1 as u,n as ie,af as I}from"./index-BrpuEMYd.js";import{A as re}from"./arrow-left-DxzJeIuz.js";import{D as xe}from"./download-B5zbgWvm.js";import{T as de}from"./trending-down-Dhb44oSt.js";const M=["January","February","March","April","May","June","July","August","September","October","November","December"];function je(){const[,k]=G("/owners/:id/bank-statement"),N=k==null?void 0:k.id,[i,w]=g.useState(""),[r,b]=g.useState(""),[x,y]=g.useState("all"),[d,v]=g.useState("all"),F=g.useMemo(()=>{const t=new URLSearchParams;return x!=="all"&&d!=="all"?(t.set("month",x),t.set("year",d)):i&&r&&(t.set("startDate",i),t.set("endDate",r)),t.toString()},[i,r,x,d]),{data:s,isLoading:V}=K({queryKey:[`/api/owners/${N}/reports/bank-statement`,F],queryFn:async()=>{const t=F?`/api/owners/${N}/reports/bank-statement?${F}`:`/api/owners/${N}/reports/bank-statement`,c=await fetch(t,{credentials:"include"});if(!c.ok)throw new Error("Failed to fetch report");return c.json()},enabled:!!N}),n=t=>ie(t),o=t=>t.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}),W=()=>{w(""),b(""),y("all"),v("all")},E=i||r||x!=="all"||d!=="all",q=new Date().getFullYear(),H=Array.from({length:6},(t,c)=>q-c),J=async()=>{if(!s)return;const{default:t}=await I(async()=>{const{default:l}=await import("./jspdf.es.min-CkxBhw3_.js").then(X=>X.j);return{default:l}},__vite__mapDeps([0,1,2])),{default:c}=await I(async()=>{const{default:l}=await import("./jspdf.plugin.autotable-CfO62xhj.js");return{default:l}},[]),a=new t,P=s.owner.name;a.setFontSize(18),a.text(`Financial Statement Report - ${P}`,14,22),a.setFontSize(10);let C="Period: ";x!=="all"&&d!=="all"?C+=`${M[parseInt(x)-1]} ${d}`:i&&r?C+=`${i} to ${r}`:C+="All Time",a.text(C,14,30),a.text(`Generated: ${new Date().toLocaleDateString()}`,14,36);const O=s.data.map(l=>[l.date,l.description,l.type==="rent_collection"?o(l.amount):"",l.type==="bank_deposit"?o(l.amount):"",l.type==="expense"?o(l.amount):""]);c(a,{startY:42,head:[["Date","Description","Rent Collection","Bank Deposit","Expense"]],body:O,styles:{fontSize:8},headStyles:{fillColor:[59,130,246]},columnStyles:{0:{cellWidth:24},1:{cellWidth:80},2:{cellWidth:28,halign:"right"},3:{cellWidth:28,halign:"right"},4:{cellWidth:28,halign:"right"}},didParseCell:function(l){l.section==="body"&&(l.column.index===2&&l.cell.text[0]&&(l.cell.styles.textColor=[37,99,235]),l.column.index===3&&l.cell.text[0]&&(l.cell.styles.textColor=[22,163,74]),l.column.index===4&&l.cell.text[0]&&(l.cell.styles.textColor=[220,38,38]))}});const S=a.lastAutoTable.finalY+10;a.setFontSize(10),a.setTextColor(37,99,235),a.text(`Total Rent Collections: ${o(s.totals.totalRentCollections)}`,14,S),a.setTextColor(22,163,74),a.text(`Total Bank Deposits: ${o(s.totals.totalBankDeposits)}`,14,S+6),a.setTextColor(220,38,38),a.text(`Total Expenses: ${o(s.totals.totalExpenses)}`,14,S+12),a.setTextColor(0,0,0),a.setFontSize(12),a.text(`Net Balance: ${o(s.totals.netBalance)}`,14,S+20),a.save(`financial_statement_${P.replace(/\s+/g,"_")}.pdf`)};return V?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(_,{className:"h-10 w-64"}),e.jsx(_,{className:"h-24 w-full"}),e.jsx(_,{className:"h-96 w-full"})]}):e.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx(Q,{href:`/owners/${N}`,children:e.jsx(B,{variant:"ghost",size:"icon",className:"shrink-0 h-8 w-8 md:h-10 md:w-10",children:e.jsx(re,{className:"h-4 w-4 md:h-5 md:w-5"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h1",{className:"text-lg md:text-2xl font-semibold flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 md:h-6 md:w-6 text-primary"}),e.jsx("span",{className:"truncate",children:"Financial Statement"})]}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground truncate",children:s==null?void 0:s.owner.name})]})]}),e.jsxs(B,{onClick:J,disabled:!(s!=null&&s.data.length),size:"sm",className:"shrink-0",children:[e.jsx(xe,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Export PDF"})]})]}),e.jsx("div",{className:"overflow-x-auto -mx-3 px-3 md:mx-0 md:px-0",children:e.jsxs("div",{className:"flex gap-2 md:gap-3 min-w-max md:min-w-0 md:flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-muted/50 rounded-lg px-2 py-1",children:[e.jsx(U,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Filters:"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{type:"date",value:i,onChange:t=>{w(t.target.value),y("all"),v("all")},className:"h-8 w-32 text-xs",placeholder:"From"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"}),e.jsx(R,{type:"date",value:r,onChange:t=>{b(t.target.value),y("all"),v("all")},className:"h-8 w-32 text-xs",placeholder:"To"})]}),e.jsxs(A,{value:x,onValueChange:t=>{y(t),w(""),b("")},children:[e.jsx(Y,{className:"h-8 w-28 text-xs",children:e.jsx(L,{placeholder:"Month"})}),e.jsxs(z,{children:[e.jsx(T,{value:"all",children:"All Months"}),M.map((t,c)=>e.jsx(T,{value:String(c+1),children:t.substring(0,3)},c))]})]}),e.jsxs(A,{value:d,onValueChange:t=>{v(t),w(""),b("")},children:[e.jsx(Y,{className:"h-8 w-24 text-xs",children:e.jsx(L,{placeholder:"Year"})}),e.jsxs(z,{children:[e.jsx(T,{value:"all",children:"All Years"}),H.map(t=>e.jsx(T,{value:String(t),children:t},t))]})]}),E&&e.jsx(B,{variant:"ghost",size:"sm",onClick:W,className:"h-8 px-2",children:e.jsx(Z,{className:"h-3 w-3"})})]})}),E&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-4",children:[e.jsxs(m,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-blue-600"}),"Rent Collections"]})}),e.jsx(h,{children:e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n((s==null?void 0:s.totals.totalRentCollections)||0)})})]}),e.jsxs(m,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-purple-600"}),"Additional Payments"]})}),e.jsx(h,{children:e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:n((s==null?void 0:s.totals.totalAdditionalPayments)||0)})})]}),e.jsxs(m,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4 text-green-600"}),"Bank Deposits"]})}),e.jsx(h,{children:e.jsx("p",{className:"text-2xl font-bold text-green-600",children:n((s==null?void 0:s.totals.totalBankDeposits)||0)})})]}),e.jsxs(m,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4 text-red-600"}),"Expenses"]})}),e.jsx(h,{children:e.jsx("p",{className:"text-2xl font-bold text-red-600",children:n((s==null?void 0:s.totals.totalExpenses)||0)})})]}),e.jsxs(m,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Net Balance"]})}),e.jsx(h,{children:e.jsx("p",{className:`text-2xl font-bold ${((s==null?void 0:s.totals.netBalance)||0)>=0?"text-green-600":"text-red-600"}`,children:n((s==null?void 0:s.totals.netBalance)||0)})})]})]}),e.jsxs(m,{children:[e.jsx(j,{children:e.jsxs(p,{className:"text-base flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5"}),"Transaction Details"]})}),e.jsx(h,{children:e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsxs($,{children:[e.jsx(f,{children:"Date"}),e.jsx(f,{children:"Description"}),e.jsx(f,{className:"text-right text-blue-600",children:"Rent Collection"}),e.jsx(f,{className:"text-right text-purple-600",children:"Additional Payment"}),e.jsx(f,{className:"text-right text-green-600",children:"Bank Deposit"}),e.jsx(f,{className:"text-right text-red-600",children:"Expense"})]})}),e.jsxs(ce,{children:[s==null?void 0:s.data.map(t=>e.jsxs($,{children:[e.jsx(u,{children:t.date}),e.jsx(u,{children:t.description}),e.jsx(u,{className:"text-right font-medium text-blue-600",children:t.type==="rent_collection"?n(t.amount):"-"}),e.jsx(u,{className:"text-right font-medium text-purple-600",children:t.type==="additional_payment"?n(t.amount):"-"}),e.jsx(u,{className:"text-right font-medium text-green-600",children:t.type==="bank_deposit"?n(t.amount):"-"}),e.jsx(u,{className:"text-right font-medium text-red-600",children:t.type==="expense"?n(t.amount):"-"})]},t.id)),(!(s!=null&&s.data)||s.data.length===0)&&e.jsx($,{children:e.jsx(u,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No transactions found for the selected period"})})]})]})})]}),s&&s.data.length>0&&e.jsx(m,{className:"border-2",children:e.jsx(h,{className:"py-4",children:e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Rent Collections"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:n(s.totals.totalRentCollections)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Bank Deposits"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:n(s.totals.totalBankDeposits)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Expenses"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:n(s.totals.totalExpenses)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Net Balance"}),e.jsx("p",{className:`text-2xl font-bold ${s.totals.netBalance>=0?"text-green-600":"text-red-600"}`,children:n(s.totals.netBalance)})]})]})})})]})}export{je as default};
