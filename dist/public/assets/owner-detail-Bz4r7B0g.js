const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-CkxBhw3_.js","assets/index-BrpuEMYd.js","assets/index-CvfNsG2m.css"])))=>i.map(i=>d[i]);
import{c as Be,r as u,M as Ue,N as te,j as e,O as qe,Q as Pe,T as Ve,V as Ge,W as Ke,e as q,S as k,C as S,a as C,b as Z,L as V,m as I,X as se,k as A,f as D,i as T,U as Q,B as Se,Y as _,Z as O,_ as b,$ as j,a0 as $,a1 as d,n as Fe,l as ne,a2 as Me,a3 as Xe,a4 as Je,a5 as Le,a6 as Ee,a7 as Qe,a8 as G,a9 as K,aa as X,ab as J,ac as z,I as ae,ad as Ce,ae as Ze,af as B}from"./index-BrpuEMYd.js";import{T as He,a as et,b as W,c as Y}from"./tabs-DKFq25_i.js";import{A as tt}from"./arrow-left-DxzJeIuz.js";import{P as Ae}from"./phone-CcKIg72Q.js";import{D as De}from"./dollar-sign-Dh7coXMs.js";import{D as ie}from"./download-B5zbgWvm.js";import{T as Te}from"./trending-up-KRZi1_xP.js";import{T as st}from"./trending-down-Dhb44oSt.js";import{R as nt,B as at,o as lt,X as rt,Y as it,T as ct,q as ot,p as dt}from"./BarChart-D5ShTKl6.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=Be("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);function xt(n,s,{checkForDefaultPrevented:a=!0}={}){return function(i){if(n==null||n(i),a===!1||!i.defaultPrevented)return s==null?void 0:s(i)}}var ht=Ue[" useInsertionEffect ".trim().toString()]||te;function pt({prop:n,defaultProp:s,onChange:a=()=>{},caller:l}){const[i,p,o]=ut({defaultProp:s,onChange:a}),r=n!==void 0,t=r?n:i;{const f=u.useRef(n!==void 0);u.useEffect(()=>{const h=f.current;h!==r&&console.warn(`${l} is changing from ${h?"controlled":"uncontrolled"} to ${r?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=r},[r,l])}const x=u.useCallback(f=>{var h;if(r){const w=jt(f)?f(n):f;w!==n&&((h=o.current)==null||h.call(o,w))}else p(f)},[r,n,p,o]);return[t,x]}function ut({defaultProp:n,onChange:s}){const[a,l]=u.useState(n),i=u.useRef(a),p=u.useRef(s);return ht(()=>{p.current=s},[s]),u.useEffect(()=>{var o;i.current!==a&&((o=p.current)==null||o.call(p,a),i.current=a)},[a,i]),[a,l,p]}function jt(n){return typeof n=="function"}function gt(n){const s=ft(n),a=u.forwardRef((l,i)=>{const{children:p,...o}=l,r=u.Children.toArray(p),t=r.find(wt);if(t){const x=t.props.children,f=r.map(h=>h===t?u.Children.count(x)>1?u.Children.only(null):u.isValidElement(x)?x.props.children:null:h);return e.jsx(s,{...o,ref:i,children:u.isValidElement(x)?u.cloneElement(x,void 0,f):null})}return e.jsx(s,{...o,ref:i,children:p})});return a.displayName=`${n}.Slot`,a}function ft(n){const s=u.forwardRef((a,l)=>{const{children:i,...p}=a;if(u.isValidElement(i)){const o=bt(i),r=yt(p,i.props);return i.type!==u.Fragment&&(r.ref=l?qe(l,o):o),u.cloneElement(i,r)}return u.Children.count(i)>1?u.Children.only(null):null});return s.displayName=`${n}.SlotClone`,s}var Nt=Symbol("radix.slottable");function wt(n){return u.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===Nt}function yt(n,s){const a={...s};for(const l in s){const i=n[l],p=s[l];/^on[A-Z]/.test(l)?i&&p?a[l]=(...r)=>{const t=p(...r);return i(...r),t}:i&&(a[l]=i):l==="style"?a[l]={...i,...p}:l==="className"&&(a[l]=[i,p].filter(Boolean).join(" "))}return{...n,...a}}function bt(n){var l,i;let s=(l=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:l.get,a=s&&"isReactWarning"in s&&s.isReactWarning;return a?n.ref:(s=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,a=s&&"isReactWarning"in s&&s.isReactWarning,a?n.props.ref:n.props.ref||n.ref)}var vt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ce=vt.reduce((n,s)=>{const a=gt(`Primitive.${s}`),l=u.forwardRef((i,p)=>{const{asChild:o,...r}=i,t=o?a:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(t,{...r,ref:p})});return l.displayName=`Primitive.${s}`,{...n,[s]:l}},{});function St(n,s){return u.useReducer((a,l)=>s[a][l]??a,n)}var Ie=n=>{const{present:s,children:a}=n,l=Ct(s),i=typeof a=="function"?a({present:l.isPresent}):u.Children.only(a),p=Pe(l.ref,Dt(i));return typeof a=="function"||l.isPresent?u.cloneElement(i,{ref:p}):null};Ie.displayName="Presence";function Ct(n){const[s,a]=u.useState(),l=u.useRef(null),i=u.useRef(n),p=u.useRef("none"),o=n?"mounted":"unmounted",[r,t]=St(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return u.useEffect(()=>{const x=H(l.current);p.current=r==="mounted"?x:"none"},[r]),te(()=>{const x=l.current,f=i.current;if(f!==n){const w=p.current,N=H(x);n?t("MOUNT"):N==="none"||(x==null?void 0:x.display)==="none"?t("UNMOUNT"):t(f&&w!==N?"ANIMATION_OUT":"UNMOUNT"),i.current=n}},[n,t]),te(()=>{if(s){let x;const f=s.ownerDocument.defaultView??window,h=N=>{const g=H(l.current).includes(CSS.escape(N.animationName));if(N.target===s&&g&&(t("ANIMATION_END"),!i.current)){const F=s.style.animationFillMode;s.style.animationFillMode="forwards",x=f.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=F)})}},w=N=>{N.target===s&&(p.current=H(l.current))};return s.addEventListener("animationstart",w),s.addEventListener("animationcancel",h),s.addEventListener("animationend",h),()=>{f.clearTimeout(x),s.removeEventListener("animationstart",w),s.removeEventListener("animationcancel",h),s.removeEventListener("animationend",h)}}else t("ANIMATION_END")},[s,t]),{isPresent:["mounted","unmountSuspended"].includes(r),ref:u.useCallback(x=>{l.current=x?getComputedStyle(x):null,a(x)},[])}}function H(n){return(n==null?void 0:n.animationName)||"none"}function Dt(n){var l,i;let s=(l=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:l.get,a=s&&"isReactWarning"in s&&s.isReactWarning;return a?n.ref:(s=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,a=s&&"isReactWarning"in s&&s.isReactWarning,a?n.props.ref:n.props.ref||n.ref)}var le="Collapsible",[Tt,Jt]=Ve(le),[Rt,oe]=Tt(le),_e=u.forwardRef((n,s)=>{const{__scopeCollapsible:a,open:l,defaultOpen:i,disabled:p,onOpenChange:o,...r}=n,[t,x]=pt({prop:l,defaultProp:i??!1,onChange:o,caller:le});return e.jsx(Rt,{scope:a,disabled:p,contentId:Ge(),open:t,onOpenToggle:u.useCallback(()=>x(f=>!f),[x]),children:e.jsx(ce.div,{"data-state":me(t),"data-disabled":p?"":void 0,...r,ref:s})})});_e.displayName=le;var Oe="CollapsibleTrigger",$e=u.forwardRef((n,s)=>{const{__scopeCollapsible:a,...l}=n,i=oe(Oe,a);return e.jsx(ce.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":me(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...l,ref:s,onClick:xt(n.onClick,i.onOpenToggle)})});$e.displayName=Oe;var de="CollapsibleContent",ke=u.forwardRef((n,s)=>{const{forceMount:a,...l}=n,i=oe(de,n.__scopeCollapsible);return e.jsx(Ie,{present:a||i.open,children:({present:p})=>e.jsx(Pt,{...l,ref:s,present:p})})});ke.displayName=de;var Pt=u.forwardRef((n,s)=>{const{__scopeCollapsible:a,present:l,children:i,...p}=n,o=oe(de,a),[r,t]=u.useState(l),x=u.useRef(null),f=Pe(s,x),h=u.useRef(0),w=h.current,N=u.useRef(0),y=N.current,g=o.open||r,F=u.useRef(g),m=u.useRef(void 0);return u.useEffect(()=>{const v=requestAnimationFrame(()=>F.current=!1);return()=>cancelAnimationFrame(v)},[]),te(()=>{const v=x.current;if(v){m.current=m.current||{transitionDuration:v.style.transitionDuration,animationName:v.style.animationName},v.style.transitionDuration="0s",v.style.animationName="none";const M=v.getBoundingClientRect();h.current=M.height,N.current=M.width,F.current||(v.style.transitionDuration=m.current.transitionDuration,v.style.animationName=m.current.animationName),t(l)}},[o.open,l]),e.jsx(ce.div,{"data-state":me(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!g,...p,ref:f,style:{"--radix-collapsible-content-height":w?`${w}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...n.style},children:g&&i})});function me(n){return n?"open":"closed"}var Ft=_e;const Mt=Ft,Lt=$e,Et=ke;function Qt(){const[,n]=Ke("/owners/:id"),s=n==null?void 0:n.id,a=m=>{const v=typeof m=="string"?parseFloat(m):m;return Fe(v)},{data:l,isLoading:i,error:p}=q({queryKey:[`/api/owners/${s}/details`],enabled:!!s}),{data:o}=q({queryKey:[`/api/owners/${s}/top-outstandings`],enabled:!!s});if(i)return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{className:"h-10 w-10"}),e.jsxs("div",{children:[e.jsx(k,{className:"h-8 w-48"}),e.jsx(k,{className:"h-4 w-32 mt-2"})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(m=>e.jsx(k,{className:"h-32"},m))}),e.jsx(k,{className:"h-96"})]});if(p||!l)return e.jsx("div",{className:"p-6",children:e.jsx(S,{className:"border-destructive",children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("p",{children:"Failed to load owner details. Please try again."})]})})})});const{owner:r,summary:t,tenants:x,commonTenants:f,bankDeposits:h,depositsByMonth:w,expenses:N,monthlyReports:y,yearlyReports:g}=l,F=t.commonShops>0||t.commonTenants>0;return e.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[e.jsx(V,{href:"/owners",children:e.jsx(I,{variant:"ghost",size:"icon",className:"shrink-0",children:e.jsx(tt,{className:"h-5 w-5"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold truncate",children:r.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 text-muted-foreground text-xs md:text-sm",children:[r.phone&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"h-3 w-3"}),r.phone]}),r.email&&e.jsx("span",{className:"truncate",children:r.email})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(V,{href:`/owners/${s}/bank-statement`,children:e.jsxs(I,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Financial Statement"})]})})})]}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{variant:"default",className:"bg-blue-600 text-xs md:text-sm",children:"My Private Properties"}),e.jsx("span",{className:"text-xs md:text-sm text-muted-foreground",children:"Sole ownership"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[e.jsxs(S,{className:"border-l-4 border-l-blue-600",children:[e.jsx(D,{className:"p-3 md:pb-2 md:p-6",children:e.jsxs(T,{className:"text-xs md:text-sm font-medium text-muted-foreground flex items-center gap-1 md:gap-2",children:[e.jsx(De,{className:"h-3 w-3 md:h-4 md:w-4"}),e.jsx("span",{className:"truncate",children:"Security Deposit"})]})}),e.jsxs(C,{className:"p-3 pt-0 md:p-6 md:pt-0",children:[e.jsx("div",{className:"text-lg md:text-2xl font-bold text-blue-600",children:a(t.totalSecurityDeposit)}),e.jsxs("p",{className:"text-[10px] md:text-xs text-muted-foreground mt-1",children:["From ",t.totalTenants," tenant(s)"]})]})]}),e.jsxs(S,{className:"border-l-4 border-l-blue-600",children:[e.jsx(D,{className:"p-3 md:pb-2 md:p-6",children:e.jsxs(T,{className:"text-xs md:text-sm font-medium text-muted-foreground flex items-center gap-1 md:gap-2",children:[e.jsx(Z,{className:"h-3 w-3 md:h-4 md:w-4"}),e.jsx("span",{className:"truncate",children:"Outstanding Dues"})]})}),e.jsxs(C,{className:"p-3 pt-0 md:p-6 md:pt-0",children:[e.jsx("div",{className:`text-lg md:text-2xl font-bold ${t.totalOutstandingDues>0?"text-red-600":"text-green-600"}`,children:a(t.totalOutstandingDues)}),e.jsx("p",{className:"text-[10px] md:text-xs text-muted-foreground mt-1",children:"Pending collection"})]})]}),e.jsxs(S,{className:"border-l-4 border-l-blue-600",children:[e.jsx(D,{className:"p-3 md:pb-2 md:p-6",children:e.jsxs(T,{className:"text-xs md:text-sm font-medium text-muted-foreground flex items-center gap-1 md:gap-2",children:[e.jsx(Q,{className:"h-3 w-3 md:h-4 md:w-4"}),"Tenants"]})}),e.jsxs(C,{className:"p-3 pt-0 md:p-6 md:pt-0",children:[e.jsx("div",{className:"text-lg md:text-2xl font-bold",children:t.totalTenants}),e.jsxs("p",{className:"text-[10px] md:text-xs text-muted-foreground mt-1",children:["In ",t.totalShops," shop(s)"]})]})]}),e.jsxs(S,{className:"border-l-4 border-l-blue-600",children:[e.jsx(D,{className:"p-3 md:pb-2 md:p-6",children:e.jsxs(T,{className:"text-xs md:text-sm font-medium text-muted-foreground flex items-center gap-1 md:gap-2",children:[e.jsx(Se,{className:"h-3 w-3 md:h-4 md:w-4"}),"Shops"]})}),e.jsxs(C,{className:"p-3 pt-0 md:p-6 md:pt-0",children:[e.jsx("div",{className:"text-lg md:text-2xl font-bold",children:t.totalShops}),e.jsx("p",{className:"text-[10px] md:text-xs text-muted-foreground mt-1",children:"Sole ownership"})]})]})]})]}),F&&e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{variant:"secondary",className:"bg-purple-100 text-purple-700 border-purple-200 text-xs md:text-sm",children:"Common/Shared Properties"}),e.jsxs("span",{className:"text-xs md:text-sm text-muted-foreground",children:["Shared among ",t.totalOwners," owner(s)"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[e.jsxs(S,{className:"border-l-4 border-l-purple-500",children:[e.jsx(D,{className:"p-3 md:pb-2 md:p-6",children:e.jsxs(T,{className:"text-xs md:text-sm font-medium text-muted-foreground flex items-center gap-1 md:gap-2",children:[e.jsx(De,{className:"h-3 w-3 md:h-4 md:w-4"}),e.jsx("span",{className:"truncate",children:"Your Share of Deposit"})]})}),e.jsxs(C,{className:"p-3 pt-0 md:p-6 md:pt-0",children:[e.jsx("div",{className:"text-lg md:text-2xl font-bold text-purple-600",children:a(t.commonSecurityDeposit)}),e.jsxs("p",{className:"text-[10px] md:text-xs text-muted-foreground mt-1",children:["From ",t.commonTenants," common tenant(s)"]})]})]}),e.jsxs(S,{className:"border-l-4 border-l-purple-500",children:[e.jsx(D,{className:"p-3 md:pb-2 md:p-6",children:e.jsxs(T,{className:"text-xs md:text-sm font-medium text-muted-foreground flex items-center gap-1 md:gap-2",children:[e.jsx(Z,{className:"h-3 w-3 md:h-4 md:w-4"}),e.jsx("span",{className:"truncate",children:"Your Share of Dues"})]})}),e.jsxs(C,{className:"p-3 pt-0 md:p-6 md:pt-0",children:[e.jsx("div",{className:`text-lg md:text-2xl font-bold ${t.commonOutstandingDues>0?"text-orange-600":"text-green-600"}`,children:a(t.commonOutstandingDues)}),e.jsx("p",{className:"text-[10px] md:text-xs text-muted-foreground mt-1",children:"Pending collection"})]})]}),e.jsxs(S,{className:"border-l-4 border-l-purple-500",children:[e.jsx(D,{className:"p-3 md:pb-2 md:p-6",children:e.jsxs(T,{className:"text-xs md:text-sm font-medium text-muted-foreground flex items-center gap-1 md:gap-2",children:[e.jsx(Q,{className:"h-3 w-3 md:h-4 md:w-4"}),e.jsx("span",{className:"truncate",children:"Common Tenants"})]})}),e.jsxs(C,{className:"p-3 pt-0 md:p-6 md:pt-0",children:[e.jsx("div",{className:"text-lg md:text-2xl font-bold",children:t.commonTenants}),e.jsxs("p",{className:"text-[10px] md:text-xs text-muted-foreground mt-1",children:["In ",t.commonShops," common shop(s)"]})]})]}),e.jsxs(S,{className:"border-l-4 border-l-purple-500",children:[e.jsx(D,{className:"p-3 md:pb-2 md:p-6",children:e.jsxs(T,{className:"text-xs md:text-sm font-medium text-muted-foreground flex items-center gap-1 md:gap-2",children:[e.jsx(Se,{className:"h-3 w-3 md:h-4 md:w-4"}),e.jsx("span",{className:"truncate",children:"Common Shops"})]})}),e.jsxs(C,{className:"p-3 pt-0 md:p-6 md:pt-0",children:[e.jsx("div",{className:"text-lg md:text-2xl font-bold",children:t.commonShops}),e.jsx("p",{className:"text-[10px] md:text-xs text-muted-foreground mt-1",children:"Shared ownership"})]})]})]})]}),e.jsx(zt,{monthlyReports:y,formatValue:a}),e.jsxs(He,{defaultValue:"tenants",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-3 md:mx-0 px-3 md:px-0",children:e.jsxs(et,{className:"inline-flex w-max md:grid md:w-full md:grid-cols-6 min-w-full",children:[e.jsxs(W,{value:"tenants",className:"text-xs md:text-sm whitespace-nowrap",children:["My Tenants (",x.length,")"]}),e.jsxs(W,{value:"reports",className:"text-xs md:text-sm whitespace-nowrap",children:[e.jsx(mt,{className:"h-3 w-3 mr-1 md:hidden"}),e.jsx("span",{children:"Reports"})]}),F&&e.jsxs(W,{value:"common-tenants",className:"text-xs md:text-sm whitespace-nowrap",children:["Common (",f.length,")"]}),e.jsxs(W,{value:"deposits",className:"text-xs md:text-sm whitespace-nowrap",children:["Deposits (",h.length,")"]}),e.jsxs(W,{value:"expenses",className:"text-xs md:text-sm whitespace-nowrap",children:["Expenses (",N.length,")"]}),e.jsx(W,{value:"income-reports",className:"text-xs md:text-sm whitespace-nowrap",children:"Income Summary"})]})}),e.jsx(Y,{value:"tenants",className:"mt-4",children:e.jsx(Re,{tenants:x,formatValue:a,ownerName:r.name,isCommon:!1})}),e.jsx(Y,{value:"reports",className:"mt-4",children:e.jsx($t,{ownerId:r.id,ownerName:r.name})}),F&&e.jsx(Y,{value:"common-tenants",className:"mt-4",children:e.jsx(Re,{tenants:f,formatValue:a,ownerName:r.name,isCommon:!0,totalOwners:t.totalOwners})}),e.jsx(Y,{value:"deposits",className:"mt-4",children:e.jsx(At,{bankDeposits:h,depositsByMonth:w,formatValue:a})}),e.jsx(Y,{value:"expenses",className:"mt-4",children:e.jsx(Ot,{expenses:N,formatValue:a})}),e.jsx(Y,{value:"income-reports",className:"mt-4",children:e.jsx(kt,{ownerName:r.name,monthlyReports:y,yearlyReports:g,formatValue:a})})]}),(o==null?void 0:o.data)&&o.data.length>0&&e.jsxs(S,{children:[e.jsx(D,{className:"p-3 md:p-6 pb-2",children:e.jsxs(T,{className:"text-sm md:text-base flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 md:h-5 md:w-5 text-red-500"}),"Top Outstanding Dues"]})}),e.jsx(C,{className:"p-0 md:p-6 md:pt-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(j,{className:"whitespace-nowrap text-xs md:text-sm",children:"Tenant"}),e.jsx(j,{className:"whitespace-nowrap text-xs md:text-sm",children:"Shop"}),e.jsx(j,{className:"text-right whitespace-nowrap text-xs md:text-sm",children:"Outstanding"})]})}),e.jsx($,{children:o.data.map((m,v)=>e.jsxs(b,{className:m.isCommon?"bg-purple-50/30":"",children:[e.jsx(d,{className:"py-2 md:py-3",children:e.jsxs("div",{children:[e.jsx(V,{href:`/tenants/${m.tenantId}`,className:"font-medium text-xs md:text-sm hover:underline hover:text-primary",children:m.tenantName}),m.businessName&&e.jsx("p",{className:"text-[10px] md:text-xs text-muted-foreground",children:m.businessName})]})}),e.jsx(d,{className:"py-2 md:py-3",children:e.jsx(A,{variant:m.isCommon?"secondary":"outline",className:`text-[10px] md:text-xs ${m.isCommon?"bg-purple-100 text-purple-700":""}`,children:m.shopLocation})}),e.jsx(d,{className:"text-right py-2 md:py-3",children:e.jsx("span",{className:"font-semibold text-red-600 text-xs md:text-sm",children:a(m.outstanding)})})]},v))})]})})})]})]})}function Re({tenants:n,formatValue:s,ownerName:a,isCommon:l=!1,totalOwners:i=1}){const p=r=>r.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}),o=async()=>{const{default:r}=await B(async()=>{const{default:N}=await import("./jspdf.es.min-CkxBhw3_.js").then(y=>y.j);return{default:N}},__vite__mapDeps([0,1,2])),{default:t}=await B(async()=>{const{default:N}=await import("./jspdf.plugin.autotable-CfO62xhj.js");return{default:N}},[]),x=new r({orientation:"landscape"}),f=x.internal.pageSize.getWidth(),h=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});x.setFillColor(37,99,235),x.rect(0,0,f,35,"F"),x.setTextColor(255,255,255),x.setFontSize(18),x.text("Tenant List",f/2,15,{align:"center"}),x.setFontSize(12),x.text(`Owner: ${a}`,f/2,24,{align:"center"}),x.setFontSize(9),x.text(`Generated: ${h}`,f/2,31,{align:"center"}),x.setTextColor(0,0,0);const w=n.reduce((N,y)=>({securityDeposit:N.securityDeposit+y.securityDeposit,monthlyRent:N.monthlyRent+y.monthlyRent,currentDues:N.currentDues+y.currentDues}),{securityDeposit:0,monthlyRent:0,currentDues:0});t(x,{startY:42,head:[["Tenant Name","Phone","Shop","Security Deposit","Monthly Rent","Current Dues","Last Payment","Status"]],body:n.map(N=>[N.name,N.phone||"-",N.shopLocation,p(N.securityDeposit),p(N.monthlyRent),p(N.currentDues),N.lastPaymentDate?new Date(N.lastPaymentDate).toLocaleDateString():"-",N.leaseStatus==="expiring_soon"?"Expiring Soon":N.leaseStatus]),foot:[["TOTAL","",`${n.length} Tenants`,p(w.securityDeposit),p(w.monthlyRent),p(w.currentDues),"",""]],theme:"striped",headStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:9},footStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold",fontSize:9},alternateRowStyles:{fillColor:[245,247,250]},columnStyles:{0:{cellWidth:45},1:{cellWidth:30},2:{cellWidth:40},3:{halign:"right",cellWidth:35},4:{halign:"right",cellWidth:30},5:{halign:"right",cellWidth:30},6:{cellWidth:30},7:{cellWidth:30}},margin:{left:10,right:10}}),x.save(`${a.replace(/\s+/g,"_")}_Tenants_${new Date().toISOString().split("T")[0]}.pdf`)};return e.jsxs(S,{className:l?"border-purple-200":"",children:[e.jsxs(D,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(T,{className:"text-base flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),l?"Common/Shared Tenants":"My Tenants",l&&e.jsxs(A,{variant:"secondary",className:"bg-purple-100 text-purple-700 border-purple-200",children:["1/",i," share"]})]}),n.length>0&&e.jsxs(I,{variant:"outline",size:"sm",onClick:o,className:"gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Export PDF"]})]}),l&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Showing your share of values. Full amounts are shown in parentheses."})]}),e.jsx(C,{className:"p-0 md:p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(j,{className:"whitespace-nowrap",children:"Tenant Name"}),e.jsx(j,{className:"whitespace-nowrap",children:"Shop Location"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:l?"Your Share of Deposit":"Security Deposit"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:l?"Your Share of Rent":"Monthly Rent"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:l?"Your Share of Dues":"Current Dues"}),e.jsx(j,{className:"whitespace-nowrap",children:"Last Payment"}),e.jsx(j,{className:"whitespace-nowrap",children:"Status"})]})}),e.jsxs($,{children:[n.map(r=>e.jsxs(b,{className:l?"bg-purple-50/30":"",children:[e.jsxs(d,{children:[e.jsx(V,{href:`/tenants/${r.id}`,children:e.jsx("span",{className:`font-medium hover:underline cursor-pointer ${r.leaseStatus==="expired"||r.leaseStatus==="terminated"?"text-red-600":"text-primary"}`,children:r.name})}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(Ae,{className:"h-3 w-3"}),r.phone]})]}),e.jsx(d,{children:e.jsx(A,{variant:l?"secondary":"outline",className:l?"bg-purple-100 text-purple-700":"",children:r.shopLocation})}),e.jsxs(d,{className:`text-right font-medium ${l?"text-purple-600":"text-blue-600"}`,children:[s(r.securityDeposit),l&&r.fullSecurityDeposit!==void 0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["(",s(r.fullSecurityDeposit),")"]})]}),e.jsxs(d,{className:"text-right",children:[s(r.monthlyRent),l&&r.fullMonthlyRent!==void 0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["(",s(r.fullMonthlyRent),")"]})]}),e.jsxs(d,{className:`text-right font-medium ${r.currentDues>0?l?"text-orange-600":"text-red-600":"text-green-600"}`,children:[s(r.currentDues),l&&r.fullCurrentDues!==void 0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["(",s(r.fullCurrentDues),")"]})]}),e.jsx(d,{children:r.lastPaymentDate?e.jsxs("span",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ne,{className:"h-3 w-3"}),new Date(r.lastPaymentDate).toLocaleDateString()]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"No payments"})}),e.jsx(d,{children:e.jsx(A,{variant:r.leaseStatus==="active"?"default":r.leaseStatus==="expiring_soon"?"secondary":"destructive",children:r.leaseStatus==="expiring_soon"?"Expiring Soon":r.leaseStatus})})]},r.leaseId)),n.length===0&&e.jsx(b,{children:e.jsx(d,{colSpan:7,className:"text-center text-muted-foreground py-8",children:l?"No common/shared tenants found":"No tenants found for this owner"})})]})]})})})]})}function At({bankDeposits:n,depositsByMonth:s,formatValue:a}){const[l,i]=u.useState({}),p=r=>{i(t=>({...t,[r]:!t[r]}))},o=Object.entries(s);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsx(D,{children:e.jsxs(T,{className:"text-base flex items-center gap-2",children:[e.jsx(Me,{className:"h-5 w-5"}),"Bank Deposits by Month"]})}),e.jsxs(C,{className:"space-y-2",children:[o.map(([r,t])=>{const x=t.reduce((h,w)=>h+parseFloat(w.amount),0),f=l[r]??!1;return e.jsxs(Mt,{open:f,onOpenChange:()=>p(r),children:[e.jsx(Lt,{asChild:!0,children:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg cursor-pointer hover:bg-muted transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f?e.jsx(Xe,{className:"h-4 w-4"}):e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:r}),e.jsxs(A,{variant:"secondary",children:[t.length," deposit(s)"]})]}),e.jsx("span",{className:"font-semibold text-green-600",children:a(x)})]})}),e.jsx(Et,{children:e.jsx("div",{className:"ml-6 mt-2 space-y-2",children:t.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:new Date(h.depositDate).toLocaleDateString()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.bankName}),h.depositSlipRef&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Ref: ",h.depositSlipRef]})]}),e.jsx("span",{className:"font-semibold text-green-600",children:a(h.amount)})]},h.id))})})]},r)}),o.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No bank deposits recorded"})]})]}),e.jsxs(S,{children:[e.jsx(D,{children:e.jsxs(T,{className:"text-base flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5"}),"All Deposits (Chronological)"]})}),e.jsx(C,{children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(j,{children:"Date"}),e.jsx(j,{children:"Bank"}),e.jsx(j,{children:"Reference"}),e.jsx(j,{children:"Notes"}),e.jsx(j,{className:"text-right",children:"Amount"})]})}),e.jsxs($,{children:[n.map(r=>e.jsxs(b,{children:[e.jsx(d,{children:new Date(r.depositDate).toLocaleDateString()}),e.jsx(d,{children:r.bankName}),e.jsx(d,{children:r.depositSlipRef||"-"}),e.jsx(d,{className:"max-w-[200px] truncate",children:r.notes||"-"}),e.jsx(d,{className:"text-right font-medium text-green-600",children:a(r.amount)})]},r.id)),n.length===0&&e.jsx(b,{children:e.jsx(d,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No bank deposits recorded"})})]})]})})]})]})}const It=["guard","cleaner","electricity","maintenance","other"];function _t(){const n=[],s=new Date;for(let a=0;a<24;a++){const l=new Date(s.getFullYear(),s.getMonth()-a,1),i=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`,p=l.toLocaleDateString("en-US",{year:"numeric",month:"long"});n.push({value:i,label:p})}return n}function Ot({expenses:n,formatValue:s}){const[a,l]=u.useState("all"),[i,p]=u.useState("all"),[o,r]=u.useState(""),[t,x]=u.useState(""),f=u.useMemo(()=>_t(),[]),h=u.useMemo(()=>n.filter(g=>!(a!=="all"&&g.expenseType!==a||i!=="all"&&g.expenseDate.substring(0,7)!==i||o&&g.expenseDate<o||t&&g.expenseDate>t)),[n,a,i,o,t]),w=a!=="all"||i!=="all"||o||t,N=()=>{l("all"),p("all"),r(""),x("")},y=h.reduce((g,F)=>g+F.allocatedAmount,0);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{className:"overflow-visible",children:e.jsxs(C,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Filters"}),w&&e.jsxs(I,{variant:"ghost",size:"sm",onClick:N,className:"h-7 px-2 text-xs ml-auto",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),"Clear All"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Category"}),e.jsxs(G,{value:a,onValueChange:l,children:[e.jsx(K,{className:"h-9",children:e.jsx(X,{placeholder:"All Categories"})}),e.jsxs(J,{children:[e.jsx(z,{value:"all",children:"All Categories"}),It.map(g=>e.jsx(z,{value:g,className:"capitalize",children:g.charAt(0).toUpperCase()+g.slice(1)},g))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Month"}),e.jsxs(G,{value:i,onValueChange:p,children:[e.jsx(K,{className:"h-9",children:e.jsx(X,{placeholder:"All Months"})}),e.jsxs(J,{children:[e.jsx(z,{value:"all",children:"All Months"}),f.map(g=>e.jsx(z,{value:g.value,children:g.label},g.value))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"From Date"}),e.jsx(ae,{type:"date",value:o,onChange:g=>r(g.target.value),className:"h-9"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"To Date"}),e.jsx(ae,{type:"date",value:t,onChange:g=>x(g.target.value),className:"h-9"})]})]})]})}),e.jsxs(S,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(T,{className:"text-base flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"Expenses ",w&&"(Filtered)"]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total (Allocated)",w&&" - Filtered"]}),e.jsx("p",{className:"text-lg font-semibold text-red-600",children:s(y)})]})]})}),e.jsx(C,{children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(j,{children:"Date"}),e.jsx(j,{children:"Type"}),e.jsx(j,{children:"Description"}),e.jsx(j,{children:"Allocation"}),e.jsx(j,{className:"text-right",children:"Amount"}),e.jsx(j,{className:"text-right",children:"Your Share"})]})}),e.jsxs($,{children:[h.map(g=>e.jsxs(b,{children:[e.jsx(d,{children:new Date(g.expenseDate).toLocaleDateString()}),e.jsx(d,{children:e.jsx(A,{variant:"outline",className:"capitalize",children:g.expenseType})}),e.jsx(d,{className:"max-w-[200px] truncate",children:g.description}),e.jsx(d,{children:e.jsx(A,{variant:g.isCommon?"secondary":"default",children:g.isCommon?"Common":"Direct"})}),e.jsx(d,{className:"text-right",children:s(g.amount)}),e.jsxs(d,{className:"text-right font-medium text-red-600",children:[s(g.allocatedAmount),g.isCommon&&e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"(shared)"})]})]},g.id)),h.length===0&&e.jsx(b,{children:e.jsx(d,{colSpan:6,className:"text-center text-muted-foreground py-8",children:w?"No expenses match the current filters":"No expenses recorded"})})]})]})})]})]})}const ee=["January","February","March","April","May","June","July","August","September","October","November","December"];function $t({ownerId:n,ownerName:s}){var xe,he,pe,ue,je,ge,fe,Ne,we,ye,be;const[a,l]=u.useState("rent"),[i,p]=u.useState((new Date().getMonth()+1).toString()),[o,r]=u.useState(new Date().getFullYear().toString()),[t,x]=u.useState(""),[f,h]=u.useState(""),[w,N]=u.useState(""),y=c=>Fe(c),g=c=>c.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}),F=u.useMemo(()=>{const R=new Date().getFullYear()+1;return Array.from({length:R-2020+1},(E,U)=>2020+U)},[]),{data:m,isLoading:v}=q({queryKey:[`/api/owners/${n}/reports/rent-payments`,i,o],queryFn:async()=>{const c=new URLSearchParams;c.append("month",i),c.append("year",o);const R=await fetch(`/api/owners/${n}/reports/rent-payments?${c}`);if(!R.ok)throw new Error("Failed to fetch");return R.json()},enabled:a==="rent"}),{data:M,isLoading:ze}=q({queryKey:[`/api/owners/${n}/reports/financial-transactions`,f,w],queryFn:async()=>{const c=new URLSearchParams;f&&c.append("startDate",f),w&&c.append("endDate",w);const R=await fetch(`/api/owners/${n}/reports/financial-transactions?${c}`);if(!R.ok)throw new Error("Failed to fetch");return R.json()},enabled:a==="financial"}),{data:P,isLoading:We}=q({queryKey:[`/api/owners/${n}/reports/tenant-ledger`,t],queryFn:async()=>{const c=new URLSearchParams;t&&c.append("tenantId",t);const R=await fetch(`/api/owners/${n}/reports/tenant-ledger?${c}`);if(!R.ok)throw new Error("Failed to fetch");return R.json()},enabled:a==="ledger"}),Ye=async()=>{var ve;if(!((ve=m==null?void 0:m.data)!=null&&ve.length))return;const{default:c}=await B(async()=>{const{default:L}=await import("./jspdf.es.min-CkxBhw3_.js").then(re=>re.j);return{default:L}},__vite__mapDeps([0,1,2])),{default:R}=await B(async()=>{const{default:L}=await import("./jspdf.plugin.autotable-CfO62xhj.js");return{default:L}},[]),E=new c({orientation:"landscape"}),U=E.internal.pageSize.getWidth();E.setFillColor(37,99,235),E.rect(0,0,U,30,"F"),E.setTextColor(255,255,255),E.setFontSize(16),E.text("Rent Payment Report",U/2,12,{align:"center"}),E.setFontSize(11),E.text(`${s} - ${ee[parseInt(i)-1]} ${o}`,U/2,22,{align:"center"}),E.setTextColor(0,0,0),R(E,{startY:38,head:[["SL","Tenant Name","Phone","Shop Location","Monthly Rent","Recent Payment","Payment Date(s)","Outstanding"]],body:m.data.map((L,re)=>[(re+1).toString(),L.tenantName,L.phone,L.shopLocation,g(L.monthlyRent),L.recentPaymentAmount>0?g(L.recentPaymentAmount):"-",L.allPaymentDates||L.recentPaymentDate||"-",g(L.currentOutstanding)]),foot:[["","TOTAL",`${m.data.length} Tenants`,"",g(m.totals.totalMonthlyRent),g(m.totals.totalRecentPayments),"",g(m.totals.totalOutstanding)]],theme:"grid",headStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:8},footStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold",fontSize:9}}),E.save(`${s.replace(/\s+/g,"_")}_Rent_Report_${ee[parseInt(i)-1]}_${o}.pdf`)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{children:e.jsxs(C,{className:"p-3 md:p-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Report Type:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(I,{variant:a==="rent"?"default":"outline",size:"sm",onClick:()=>l("rent"),className:"text-xs md:text-sm",children:"Rent Payments"}),e.jsx(I,{variant:a==="financial"?"default":"outline",size:"sm",onClick:()=>l("financial"),className:"text-xs md:text-sm",children:"Financial Transactions"}),e.jsx(I,{variant:a==="ledger"?"default":"outline",size:"sm",onClick:()=>l("ledger"),className:"text-xs md:text-sm",children:"Tenant Ledger"})]})]}),a==="rent"&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-3 pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs md:text-sm",children:"Filter:"})]}),e.jsxs(G,{value:i,onValueChange:p,children:[e.jsx(K,{className:"w-28 md:w-32 h-8 text-xs md:text-sm",children:e.jsx(X,{})}),e.jsx(J,{children:ee.map((c,R)=>e.jsx(z,{value:(R+1).toString(),children:c},R))})]}),e.jsxs(G,{value:o,onValueChange:r,children:[e.jsx(K,{className:"w-20 md:w-24 h-8 text-xs md:text-sm",children:e.jsx(X,{})}),e.jsx(J,{children:F.map(c=>e.jsx(z,{value:c.toString(),children:c},c))})]}),(xe=m==null?void 0:m.data)!=null&&xe.length?e.jsxs(I,{size:"sm",variant:"outline",onClick:Ye,className:"h-8 text-xs md:text-sm ml-auto",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),"PDF"]}):null]}),a==="financial"&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-3 pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs md:text-sm",children:"Date Range:"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"date",value:f,onChange:c=>h(c.target.value),className:"w-32 md:w-36 h-8 text-xs md:text-sm",placeholder:"Start Date"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"to"}),e.jsx(ae,{type:"date",value:w,onChange:c=>N(c.target.value),className:"w-32 md:w-36 h-8 text-xs md:text-sm",placeholder:"End Date"})]}),(f||w)&&e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>{h(""),N("")},className:"h-8 text-xs text-muted-foreground",children:"Clear"})]}),a==="ledger"&&(P==null?void 0:P.tenants)&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-3 pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs md:text-sm",children:"Select Tenant:"})]}),e.jsxs(G,{value:t,onValueChange:x,children:[e.jsx(K,{className:"w-48 md:w-64 h-8 text-xs md:text-sm",children:e.jsx(X,{placeholder:"Choose a tenant"})}),e.jsx(J,{children:P.tenants.map(c=>e.jsxs(z,{value:c.id.toString(),children:[c.name," - ",c.phone]},c.id))})]})]})]})}),a==="rent"&&e.jsxs(S,{children:[e.jsx(D,{className:"p-3 md:p-6",children:e.jsxs(T,{className:"text-sm md:text-base flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4 md:h-5 md:w-5"}),"Rent Payment Report - ",ee[parseInt(i)-1]," ",o]})}),e.jsx(C,{className:"p-0 md:p-6",children:v?e.jsx("div",{className:"p-6",children:e.jsx(k,{className:"h-64"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(j,{className:"w-10 text-center whitespace-nowrap",children:"SL"}),e.jsx(j,{className:"whitespace-nowrap",children:"Tenant Name"}),e.jsx(j,{className:"whitespace-nowrap",children:"Phone"}),e.jsx(j,{className:"whitespace-nowrap",children:"Shop Location"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:"Monthly Rent"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:"Recent Payment"}),e.jsx(j,{className:"text-center whitespace-nowrap",children:"Payment Date(s)"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:"Outstanding"})]})}),e.jsxs($,{children:[(he=m==null?void 0:m.data)==null?void 0:he.map((c,R)=>e.jsxs(b,{className:c.isCommon?"bg-purple-50/30":"",children:[e.jsx(d,{className:"text-center",children:R+1}),e.jsx(d,{className:"font-medium",children:e.jsx(V,{href:`/tenants/${c.tenantId}`,className:`hover:underline ${c.leaseStatus==="expired"||c.leaseStatus==="terminated"?"text-red-600":"text-primary"}`,children:c.tenantName})}),e.jsx(d,{children:c.phone}),e.jsx(d,{children:e.jsx(A,{variant:c.isCommon?"secondary":"outline",className:c.isCommon?"bg-purple-100 text-purple-700":"",children:c.shopLocation})}),e.jsx(d,{className:"text-right",children:y(c.monthlyRent)}),e.jsx(d,{className:"text-right text-green-600",children:c.recentPaymentAmount>0?y(c.recentPaymentAmount):"-"}),e.jsx(d,{className:"text-center text-xs",children:c.allPaymentDates||c.recentPaymentDate||"-"}),e.jsx(d,{className:`text-right font-medium ${c.currentOutstanding>0?"text-red-600":"text-green-600"}`,children:y(c.currentOutstanding)})]},c.leaseId)),!((pe=m==null?void 0:m.data)!=null&&pe.length)&&e.jsx(b,{children:e.jsx(d,{colSpan:8,className:"text-center text-muted-foreground py-8",children:"No data available"})})]}),(ue=m==null?void 0:m.data)!=null&&ue.length?e.jsx("tfoot",{children:e.jsxs(b,{className:"bg-muted/50 font-semibold",children:[e.jsx(d,{}),e.jsx(d,{children:"TOTAL"}),e.jsxs(d,{children:[m.data.length," Tenants"]}),e.jsx(d,{}),e.jsx(d,{className:"text-right",children:y(m.totals.totalMonthlyRent)}),e.jsx(d,{className:"text-right text-green-600",children:y(m.totals.totalRecentPayments)}),e.jsx(d,{}),e.jsx(d,{className:"text-right text-red-600",children:y(m.totals.totalOutstanding)})]})}):null]})})})]}),a==="financial"&&e.jsxs(S,{children:[e.jsx(D,{className:"p-3 md:p-6",children:e.jsxs(T,{className:"text-sm md:text-base flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4 md:h-5 md:w-5"}),"Financial Transactions",(f||w)&&e.jsx("span",{className:"text-muted-foreground font-normal",children:f&&w?` (${new Date(f).toLocaleDateString()} - ${new Date(w).toLocaleDateString()})`:f?` (From ${new Date(f).toLocaleDateString()})`:` (Until ${new Date(w).toLocaleDateString()})`})]})}),e.jsx(C,{className:"p-0 md:p-6",children:ze?e.jsx("div",{className:"p-6",children:e.jsx(k,{className:"h-64"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(j,{className:"whitespace-nowrap",children:"Date"}),e.jsx(j,{className:"whitespace-nowrap",children:"Type"}),e.jsx(j,{className:"whitespace-nowrap",children:"Category"}),e.jsx(j,{className:"whitespace-nowrap",children:"Description"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:"Amount"})]})}),e.jsxs($,{children:[(je=M==null?void 0:M.data)==null?void 0:je.map(c=>e.jsxs(b,{className:c.isCommon?"bg-purple-50/30":"",children:[e.jsx(d,{children:new Date(c.date).toLocaleDateString()}),e.jsx(d,{children:e.jsx(A,{variant:c.type==="deposit"?"default":"secondary",className:c.type==="deposit"?"bg-green-600":"bg-red-600 text-white",children:c.type==="deposit"?"Deposit":"Expense"})}),e.jsx(d,{children:c.category}),e.jsx(d,{className:"max-w-[200px] truncate",children:c.description}),e.jsx(d,{className:`text-right font-medium ${c.type==="deposit"?"text-green-600":"text-red-600"}`,children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.type==="deposit"?"+":"-",y(c.amount),c.type==="deposit"&&e.jsx(Ce,{payment:{id:c.id,amount:c.amount,paymentDate:c.date,rentMonths:c.rentMonths||null,notes:c.description}})]})})]},c.id)),!((ge=M==null?void 0:M.data)!=null&&ge.length)&&e.jsx(b,{children:e.jsx(d,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No transactions found"})})]}),(fe=M==null?void 0:M.data)!=null&&fe.length?e.jsxs("tfoot",{children:[e.jsxs(b,{className:"bg-green-50 font-semibold",children:[e.jsx(d,{colSpan:4,children:"Total Deposits"}),e.jsxs(d,{className:"text-right text-green-600",children:["+",y(M.totals.totalDeposits)]})]}),e.jsxs(b,{className:"bg-red-50 font-semibold",children:[e.jsx(d,{colSpan:4,children:"Total Expenses"}),e.jsxs(d,{className:"text-right text-red-600",children:["-",y(M.totals.totalExpenses)]})]})]}):null]})})})]}),a==="ledger"&&e.jsxs(S,{children:[e.jsx(D,{className:"p-3 md:p-6",children:e.jsxs(T,{className:"text-sm md:text-base flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 md:h-5 md:w-5"}),"Tenant Ledger ",(we=(Ne=P==null?void 0:P.ledger)==null?void 0:Ne.tenant)!=null&&we.name?`- ${P.ledger.tenant.name}`:""]})}),e.jsx(C,{className:"p-0 md:p-6",children:We?e.jsx("div",{className:"p-6",children:e.jsx(k,{className:"h-64"})}):t?(be=(ye=P==null?void 0:P.ledger)==null?void 0:ye.entries)!=null&&be.length?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(j,{className:"whitespace-nowrap",children:"Date"}),e.jsx(j,{className:"whitespace-nowrap",children:"Description"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:"Debit"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:"Credit"}),e.jsx(j,{className:"text-right whitespace-nowrap",children:"Balance"}),e.jsx(j,{className:"w-[50px]"})]})}),e.jsx($,{children:P.ledger.entries.map(c=>e.jsxs(b,{children:[e.jsx(d,{children:new Date(c.date).toLocaleDateString()}),e.jsx(d,{children:c.description}),e.jsx(d,{className:"text-right text-red-600",children:c.debit>0?y(c.debit):"-"}),e.jsx(d,{className:"text-right text-green-600",children:c.credit>0?y(c.credit):"-"}),e.jsx(d,{className:`text-right font-medium ${c.balance>0?"text-red-600":"text-green-600"}`,children:y(c.balance)}),e.jsx(d,{children:c.type==="payment"&&c.paymentId&&e.jsx(Ce,{payment:{id:c.paymentId,amount:c.credit,paymentDate:c.date,rentMonths:c.rentMonths||null,notes:c.notes||"",receiptNumber:c.receiptNumber||""}})})]},c.id))}),e.jsx("tfoot",{children:e.jsxs(b,{className:"bg-muted/50 font-semibold",children:[e.jsx(d,{colSpan:2,children:"TOTAL"}),e.jsx(d,{className:"text-right text-red-600",children:y(P.ledger.totals.totalDebit)}),e.jsx(d,{className:"text-right text-green-600",children:y(P.ledger.totals.totalCredit)}),e.jsx(d,{className:`text-right font-bold ${P.ledger.totals.currentBalance>0?"text-red-600":"text-green-600"}`,children:y(P.ledger.totals.currentBalance)})]})})]})}):e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(se,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No ledger entries found for this tenant"})]}):e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(Q,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Select a tenant to view their ledger"})]})})]})]})}function kt({ownerName:n,monthlyReports:s=[],yearlyReports:a=[],formatValue:l}){const i=o=>o.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}),p=async()=>{const{default:o}=await B(async()=>{const{default:m}=await import("./jspdf.es.min-CkxBhw3_.js").then(v=>v.j);return{default:m}},__vite__mapDeps([0,1,2])),{default:r}=await B(async()=>{const{default:m}=await import("./jspdf.plugin.autotable-CfO62xhj.js");return{default:m}},[]),t=new o,x=t.internal.pageSize.getWidth(),f=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});t.setFillColor(37,99,235),t.rect(0,0,x,45,"F"),t.setTextColor(255,255,255),t.setFontSize(20),t.text("Income & Expense Report",x/2,18,{align:"center"}),t.setFontSize(14),t.text(n,x/2,28,{align:"center"}),t.setFontSize(10),t.text(`Generated: ${f}`,x/2,38,{align:"center"}),t.setTextColor(0,0,0);let h=55;a.length>0&&(t.setFontSize(13),t.setTextColor(37,99,235),t.text("Yearly Summary",14,h),t.setTextColor(0,0,0),h+=6,r(t,{startY:h,head:[["Year","Rent Collection","Bank Deposits","Expenses","Net Income"]],body:a.map(m=>[m.year.toString(),i(m.rentCollection),i(m.bankDeposits),i(m.expenses),(m.netIncome>=0?"":"-")+i(Math.abs(m.netIncome))]),theme:"striped",headStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold",fontSize:10},bodyStyles:{fontSize:10},alternateRowStyles:{fillColor:[245,247,250]},columnStyles:{0:{cellWidth:25},1:{halign:"right",cellWidth:40},2:{halign:"right",cellWidth:40},3:{halign:"right",cellWidth:35},4:{halign:"right",cellWidth:40,fontStyle:"bold"}},margin:{left:14,right:14}}),h=t.lastAutoTable.finalY+18),s.length>0&&(t.setFontSize(13),t.setTextColor(37,99,235),t.text("Monthly Breakdown (Last 12 Months)",14,h),t.setTextColor(0,0,0),h+=6,r(t,{startY:h,head:[["Month","Rent Collection","Bank Deposits","Expenses","Net Income"]],body:s.map(m=>[m.month,i(m.rentCollection),i(m.bankDeposits),i(m.expenses),(m.netIncome>=0?"":"-")+i(Math.abs(m.netIncome))]),theme:"striped",headStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold",fontSize:10},bodyStyles:{fontSize:10},alternateRowStyles:{fillColor:[245,247,250]},columnStyles:{0:{cellWidth:45},1:{halign:"right",cellWidth:38},2:{halign:"right",cellWidth:38},3:{halign:"right",cellWidth:30},4:{halign:"right",cellWidth:35,fontStyle:"bold"}},margin:{left:14,right:14}}));const w=s.reduce((m,v)=>m+v.rentCollection,0),N=s.reduce((m,v)=>m+v.bankDeposits,0),y=s.reduce((m,v)=>m+v.expenses,0),g=s.reduce((m,v)=>m+v.netIncome,0);h=t.lastAutoTable.finalY+12,t.setFillColor(248,250,252),t.roundedRect(14,h-4,x-28,38,3,3,"F"),t.setFontSize(11),t.setTextColor(71,85,105),t.text("Summary Totals",20,h+4),t.setFontSize(10),t.setTextColor(0,0,0),t.text("Rent Collection:",20,h+14),t.text(i(w),x-20,h+14,{align:"right"}),t.text("Bank Deposits:",20,h+21),t.text(i(N),x-20,h+21,{align:"right"}),t.text("Expenses:",20,h+28),t.text(i(y),x-20,h+28,{align:"right"}),h+=42,t.setFillColor(37,99,235),t.roundedRect(14,h-4,x-28,14,3,3,"F"),t.setFontSize(11),t.setTextColor(255,255,255),t.text("Net Income:",20,h+5),t.setFontSize(12),t.text((g>=0?"":"-")+i(Math.abs(g)),x-20,h+5,{align:"right"});const F=`${n.replace(/\s+/g,"_")}_Income_Report_${new Date().toISOString().split("T")[0]}.pdf`;t.save(F)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(I,{onClick:p,variant:"outline",className:"gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Export PDF"]})}),e.jsxs(S,{children:[e.jsx(D,{children:e.jsxs(T,{className:"text-base flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5"}),"Yearly Summary"]})}),e.jsx(C,{children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(j,{children:"Year"}),e.jsx(j,{className:"text-right",children:"Rent Collection"}),e.jsx(j,{className:"text-right",children:"Bank Deposits"}),e.jsx(j,{className:"text-right",children:"Expenses"}),e.jsx(j,{className:"text-right",children:"Net Income"})]})}),e.jsxs($,{children:[a.map(o=>e.jsxs(b,{children:[e.jsx(d,{className:"font-medium",children:o.year}),e.jsx(d,{className:"text-right text-green-600",children:l(o.rentCollection)}),e.jsx(d,{className:"text-right text-blue-600",children:l(o.bankDeposits)}),e.jsx(d,{className:"text-right text-red-600",children:l(o.expenses)}),e.jsxs(d,{className:`text-right font-bold ${o.netIncome>=0?"text-green-600":"text-red-600"}`,children:[o.netIncome>=0?"":"-",l(Math.abs(o.netIncome))]})]},o.year)),a.length===0&&e.jsx(b,{children:e.jsx(d,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No data available"})})]})]})})]}),e.jsxs(S,{children:[e.jsx(D,{children:e.jsxs(T,{className:"text-base flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5"}),"Monthly Breakdown (Last 12 Months)"]})}),e.jsx(C,{children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(j,{children:"Month"}),e.jsx(j,{className:"text-right",children:"Rent Collection"}),e.jsx(j,{className:"text-right",children:"Bank Deposits"}),e.jsx(j,{className:"text-right",children:"Expenses"}),e.jsx(j,{className:"text-right",children:"Net Income"})]})}),e.jsxs($,{children:[s.map((o,r)=>e.jsxs(b,{children:[e.jsx(d,{className:"font-medium",children:o.month}),e.jsx(d,{className:"text-right text-green-600",children:l(o.rentCollection)}),e.jsx(d,{className:"text-right text-blue-600",children:l(o.bankDeposits)}),e.jsx(d,{className:"text-right text-red-600",children:l(o.expenses)}),e.jsx(d,{className:`text-right font-bold ${o.netIncome>=0?"text-green-600":"text-red-600"}`,children:e.jsxs("span",{className:"flex items-center justify-end gap-1",children:[o.netIncome>=0?e.jsx(Te,{className:"h-3 w-3"}):e.jsx(st,{className:"h-3 w-3"}),o.netIncome>=0?"":"-",l(Math.abs(o.netIncome))]})})]},r)),s.length===0&&e.jsx(b,{children:e.jsx(d,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No data available"})})]})]})})]})]})}function zt({monthlyReports:n,formatValue:s}){const a=[...n||[]].reverse(),l=({active:i,payload:p,label:o})=>i&&p&&p.length?e.jsxs("div",{className:"bg-background border rounded-lg p-3 shadow-lg text-sm",children:[e.jsx("p",{className:"font-medium mb-2",children:o}),p.map((r,t)=>e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:r.color}}),e.jsxs("span",{className:"text-muted-foreground",children:[r.name,":"]}),e.jsx("span",{className:"font-medium",children:s(r.value)})]},t))]}):null;return a.length===0?null:e.jsxs(S,{children:[e.jsx(D,{children:e.jsxs(T,{className:"text-base flex items-center gap-2",children:[e.jsx(Ze,{className:"h-5 w-5 text-blue-600"}),"Monthly Rent Collection Trend"]})}),e.jsx(C,{children:e.jsx("div",{className:"h-[300px] w-full",children:e.jsx(nt,{width:"100%",height:"100%",children:e.jsxs(at,{data:a,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(lt,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--border))"}),e.jsx(rt,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"hsl(var(--muted-foreground))",fontSize:12},dy:10}),e.jsx(it,{axisLine:!1,tickLine:!1,tick:{fill:"hsl(var(--muted-foreground))",fontSize:12},tickFormatter:i=>`${i/1e3}k`}),e.jsx(ct,{content:e.jsx(l,{}),cursor:{fill:"hsl(var(--muted)/0.4)"}}),e.jsx(ot,{wrapperStyle:{paddingTop:"20px"}}),e.jsx(dt,{dataKey:"rentCollection",name:"Rent Collection",fill:"hsl(var(--primary))",radius:[4,4,0,0],barSize:40})]})})})})]})}export{Qt as default};
